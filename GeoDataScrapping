{
 "cells": [
  {
   "cell_type": "code",
   "execution_count": 1,
   "id": "de30f85a",
   "metadata": {
    "_cell_guid": "b1076dfc-b9ad-4769-8c92-a6c4dae69d19",
    "_uuid": "8f2839f25d086af736a60e9eeb907d3b93b6e0e5",
    "execution": {
     "iopub.execute_input": "2024-05-28T05:14:35.753857Z",
     "iopub.status.busy": "2024-05-28T05:14:35.753292Z",
     "iopub.status.idle": "2024-05-28T05:14:36.947171Z",
     "shell.execute_reply": "2024-05-28T05:14:36.946123Z"
    },
    "papermill": {
     "duration": 1.207053,
     "end_time": "2024-05-28T05:14:36.949789",
     "exception": false,
     "start_time": "2024-05-28T05:14:35.742736",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [],
   "source": [
    "import requests as rq\n",
    "import pandas as pd\n",
    "from bs4 import BeautifulSoup\n",
    "from tqdm import tqdm\n",
    "import json\n",
    "import time"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 2,
   "id": "dc9f844e",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2024-05-28T05:14:36.968979Z",
     "iopub.status.busy": "2024-05-28T05:14:36.968393Z",
     "iopub.status.idle": "2024-05-28T05:14:36.974001Z",
     "shell.execute_reply": "2024-05-28T05:14:36.972691Z"
    },
    "papermill": {
     "duration": 0.018005,
     "end_time": "2024-05-28T05:14:36.976561",
     "exception": false,
     "start_time": "2024-05-28T05:14:36.958556",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [],
   "source": [
    "headers = {\n",
    "    \"User-Agent\": \"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/58.0.3029.110 Safari/537.3\"\n",
    "}"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 3,
   "id": "f192bb9e",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2024-05-28T05:14:36.995972Z",
     "iopub.status.busy": "2024-05-28T05:14:36.995589Z",
     "iopub.status.idle": "2024-05-28T05:14:37.000403Z",
     "shell.execute_reply": "2024-05-28T05:14:36.999462Z"
    },
    "papermill": {
     "duration": 0.017124,
     "end_time": "2024-05-28T05:14:37.002693",
     "exception": false,
     "start_time": "2024-05-28T05:14:36.985569",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [],
   "source": [
    "def get_soup(url):\n",
    "    url = url\n",
    "    r = rq.get(url,headers = headers)\n",
    "    soup = BeautifulSoup(r.text,'html.parser')\n",
    "    return soup"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 4,
   "id": "d809c793",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2024-05-28T05:14:37.022605Z",
     "iopub.status.busy": "2024-05-28T05:14:37.021462Z",
     "iopub.status.idle": "2024-05-28T05:14:37.027091Z",
     "shell.execute_reply": "2024-05-28T05:14:37.025962Z"
    },
    "papermill": {
     "duration": 0.017998,
     "end_time": "2024-05-28T05:14:37.029406",
     "exception": false,
     "start_time": "2024-05-28T05:14:37.011408",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [],
   "source": [
    "def get_all_links(soup):  \n",
    "    listlink = []\n",
    "    links = soup.find_all('a')\n",
    "    for link in links:\n",
    "        part = link['href']\n",
    "        listlink.append(f'https://villageinfo.in{part}')\n",
    "    return listlink"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 5,
   "id": "e7227d0d",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2024-05-28T05:14:37.048913Z",
     "iopub.status.busy": "2024-05-28T05:14:37.048520Z",
     "iopub.status.idle": "2024-05-28T05:14:37.055288Z",
     "shell.execute_reply": "2024-05-28T05:14:37.054089Z"
    },
    "papermill": {
     "duration": 0.01986,
     "end_time": "2024-05-28T05:14:37.057829",
     "exception": false,
     "start_time": "2024-05-28T05:14:37.037969",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [],
   "source": [
    "def get_all_links_table(soup):\n",
    "    listlink = []\n",
    "    table = soup.find('table')\n",
    "    tbody = table.find('tbody')\n",
    "    trs = tbody.find_all('tr')\n",
    "    for tr in trs:\n",
    "        tds = tr.find_all('td')\n",
    "        for td in tds:\n",
    "            if td.find('a') is not None:   \n",
    "                link = td.find('a')\n",
    "                part = link['href']\n",
    "                if part[0] == '/':\n",
    "                    listlink.append(f'https://villageinfo.in{part}')\n",
    "                else:\n",
    "                    listlink.append(f'https://villageinfo.in/{part}')\n",
    "    return listlink"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 6,
   "id": "fc54ccb7",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2024-05-28T05:14:37.076808Z",
     "iopub.status.busy": "2024-05-28T05:14:37.076386Z",
     "iopub.status.idle": "2024-05-28T05:14:37.084751Z",
     "shell.execute_reply": "2024-05-28T05:14:37.083540Z"
    },
    "papermill": {
     "duration": 0.020797,
     "end_time": "2024-05-28T05:14:37.087185",
     "exception": false,
     "start_time": "2024-05-28T05:14:37.066388",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [],
   "source": [
    "def construct_table(table):\n",
    "    head = table.find('thead')\n",
    "    headlist = []\n",
    "    if head is not None:\n",
    "        heads = head.find_all('th')\n",
    "        for hd in heads:\n",
    "            txt = hd.text\n",
    "            headlist.append(txt)\n",
    "    \n",
    "    body = table.find('tbody')\n",
    "    trslist = body.find_all('tr')\n",
    "    table_body = []\n",
    "    for tr in trslist:\n",
    "        final_row = []\n",
    "        tds = tr.find_all('td')\n",
    "        for td in tds:\n",
    "            final_row.append(td.text)\n",
    "        table_body.append(final_row)\n",
    "        \n",
    "    if len(headlist) != 0:\n",
    "        final_table_list = [headlist] + table_body\n",
    "        return final_table_list\n",
    "    else:\n",
    "        final_table_list = table_body\n",
    "        return final_table_list"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "0a2da344",
   "metadata": {
    "papermill": {
     "duration": 0.008163,
     "end_time": "2024-05-28T05:14:37.105197",
     "exception": false,
     "start_time": "2024-05-28T05:14:37.097034",
     "status": "completed"
    },
    "tags": []
   },
   "source": []
  },
  {
   "cell_type": "markdown",
   "id": "0530b17e",
   "metadata": {
    "papermill": {
     "duration": 0.008147,
     "end_time": "2024-05-28T05:14:37.121746",
     "exception": false,
     "start_time": "2024-05-28T05:14:37.113599",
     "status": "completed"
    },
    "tags": []
   },
   "source": [
    "# get states"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 7,
   "id": "5df02962",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2024-05-28T05:14:37.140952Z",
     "iopub.status.busy": "2024-05-28T05:14:37.140126Z",
     "iopub.status.idle": "2024-05-28T05:14:37.889764Z",
     "shell.execute_reply": "2024-05-28T05:14:37.888552Z"
    },
    "papermill": {
     "duration": 0.762084,
     "end_time": "2024-05-28T05:14:37.892257",
     "exception": false,
     "start_time": "2024-05-28T05:14:37.130173",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [
    {
     "data": {
      "text/plain": [
       "['https://villageinfo.in/andaman-&-nicobar-islands.html',\n",
       " 'https://villageinfo.in/andhra-pradesh.html',\n",
       " 'https://villageinfo.in/arunachal-pradesh.html',\n",
       " 'https://villageinfo.in/assam.html',\n",
       " 'https://villageinfo.in/bihar.html',\n",
       " 'https://villageinfo.in/chandigarh.html',\n",
       " 'https://villageinfo.in/chhattisgarh.html',\n",
       " 'https://villageinfo.in/dadra-&-nagar-haveli.html',\n",
       " 'https://villageinfo.in/daman-&-diu.html',\n",
       " 'https://villageinfo.in/delhi.html',\n",
       " 'https://villageinfo.in/goa.html',\n",
       " 'https://villageinfo.in/gujarat.html',\n",
       " 'https://villageinfo.in/haryana.html',\n",
       " 'https://villageinfo.in/himachal-pradesh.html',\n",
       " 'https://villageinfo.in/jammu-&-kashmir.html',\n",
       " 'https://villageinfo.in/jharkhand.html',\n",
       " 'https://villageinfo.in/karnataka.html',\n",
       " 'https://villageinfo.in/kerala.html',\n",
       " 'https://villageinfo.in/lakshadweep.html',\n",
       " 'https://villageinfo.in/madhya-pradesh.html',\n",
       " 'https://villageinfo.in/maharashtra.html',\n",
       " 'https://villageinfo.in/manipur.html',\n",
       " 'https://villageinfo.in/meghalaya.html',\n",
       " 'https://villageinfo.in/mizoram.html',\n",
       " 'https://villageinfo.in/nagaland.html',\n",
       " 'https://villageinfo.in/odisha.html',\n",
       " 'https://villageinfo.in/puducherry.html',\n",
       " 'https://villageinfo.in/punjab.html',\n",
       " 'https://villageinfo.in/rajasthan.html',\n",
       " 'https://villageinfo.in/sikkim.html',\n",
       " 'https://villageinfo.in/tamil-nadu.html',\n",
       " 'https://villageinfo.in/telangana.html',\n",
       " 'https://villageinfo.in/tripura.html',\n",
       " 'https://villageinfo.in/uttar-pradesh.html',\n",
       " 'https://villageinfo.in/uttarakhand.html',\n",
       " 'https://villageinfo.in/west-bengal.html',\n",
       " 'https://villageinfo.in/',\n",
       " 'https://villageinfo.in/contact.html',\n",
       " 'https://villageinfo.in/terms.html',\n",
       " 'https://villageinfo.in/privacy.html']"
      ]
     },
     "execution_count": 7,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "url = 'https://villageinfo.in/'\n",
    "soup = get_soup(url)\n",
    "states_list = get_all_links(soup)\n",
    "states_list"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "d37810ab",
   "metadata": {
    "papermill": {
     "duration": 0.008262,
     "end_time": "2024-05-28T05:14:37.910124",
     "exception": false,
     "start_time": "2024-05-28T05:14:37.901862",
     "status": "completed"
    },
    "tags": []
   },
   "source": [
    "# get districts in a state"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 8,
   "id": "55f6b643",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2024-05-28T05:14:37.929295Z",
     "iopub.status.busy": "2024-05-28T05:14:37.928888Z",
     "iopub.status.idle": "2024-05-28T05:14:38.705701Z",
     "shell.execute_reply": "2024-05-28T05:14:38.704619Z"
    },
    "papermill": {
     "duration": 0.789444,
     "end_time": "2024-05-28T05:14:38.708186",
     "exception": false,
     "start_time": "2024-05-28T05:14:37.918742",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [
    {
     "data": {
      "text/plain": [
       "['https://villageinfo.in/maharashtra/ahmadnagar.html',\n",
       " 'https://villageinfo.in/maharashtra/akola.html',\n",
       " 'https://villageinfo.in/maharashtra/amravati.html',\n",
       " 'https://villageinfo.in/maharashtra/aurangabad.html',\n",
       " 'https://villageinfo.in/maharashtra/bhandara.html',\n",
       " 'https://villageinfo.in/maharashtra/bid.html',\n",
       " 'https://villageinfo.in/maharashtra/buldana.html',\n",
       " 'https://villageinfo.in/maharashtra/chandrapur.html',\n",
       " 'https://villageinfo.in/maharashtra/dhule.html',\n",
       " 'https://villageinfo.in/maharashtra/gadchiroli.html',\n",
       " 'https://villageinfo.in/maharashtra/gondiya.html',\n",
       " 'https://villageinfo.in/maharashtra/hingoli.html',\n",
       " 'https://villageinfo.in/maharashtra/jalgaon.html',\n",
       " 'https://villageinfo.in/maharashtra/jalna.html',\n",
       " 'https://villageinfo.in/maharashtra/kolhapur.html',\n",
       " 'https://villageinfo.in/maharashtra/latur.html',\n",
       " 'https://villageinfo.in/maharashtra/mumbai.html',\n",
       " 'https://villageinfo.in/maharashtra/mumbai-suburban.html',\n",
       " 'https://villageinfo.in/maharashtra/nagpur.html',\n",
       " 'https://villageinfo.in/maharashtra/nanded.html',\n",
       " 'https://villageinfo.in/maharashtra/nandurbar.html',\n",
       " 'https://villageinfo.in/maharashtra/nashik.html',\n",
       " 'https://villageinfo.in/maharashtra/osmanabad.html',\n",
       " 'https://villageinfo.in/maharashtra/parbhani.html',\n",
       " 'https://villageinfo.in/maharashtra/pune.html',\n",
       " 'https://villageinfo.in/maharashtra/raigarh.html',\n",
       " 'https://villageinfo.in/maharashtra/ratnagiri.html',\n",
       " 'https://villageinfo.in/maharashtra/sangli.html',\n",
       " 'https://villageinfo.in/maharashtra/satara.html',\n",
       " 'https://villageinfo.in/maharashtra/sindhudurg.html',\n",
       " 'https://villageinfo.in/maharashtra/solapur.html',\n",
       " 'https://villageinfo.in/maharashtra/thane.html',\n",
       " 'https://villageinfo.in/maharashtra/wardha.html',\n",
       " 'https://villageinfo.in/maharashtra/washim.html',\n",
       " 'https://villageinfo.in/maharashtra/yavatmal.html']"
      ]
     },
     "execution_count": 8,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "url2 = 'https://villageinfo.in/maharashtra.html'\n",
    "soup2 = get_soup(url2)\n",
    "dist_list = get_all_links_table(soup2)\n",
    "dist_list"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "f6f1bcc9",
   "metadata": {
    "papermill": {
     "duration": 0.008327,
     "end_time": "2024-05-28T05:14:38.725290",
     "exception": false,
     "start_time": "2024-05-28T05:14:38.716963",
     "status": "completed"
    },
    "tags": []
   },
   "source": [
    "# Get talukas in a district"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 9,
   "id": "1453f8ed",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2024-05-28T05:14:38.744658Z",
     "iopub.status.busy": "2024-05-28T05:14:38.744247Z",
     "iopub.status.idle": "2024-05-28T05:14:39.847966Z",
     "shell.execute_reply": "2024-05-28T05:14:39.846685Z"
    },
    "papermill": {
     "duration": 1.116441,
     "end_time": "2024-05-28T05:14:39.850540",
     "exception": false,
     "start_time": "2024-05-28T05:14:38.734099",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [
    {
     "data": {
      "text/plain": [
       "['https://villageinfo.in/maharashtra/nashik/baglan.html',\n",
       " 'https://villageinfo.in/maharashtra/nashik/chandvad.html',\n",
       " 'https://villageinfo.in/maharashtra/nashik/deola.html',\n",
       " 'https://villageinfo.in/maharashtra/nashik/dindori.html',\n",
       " 'https://villageinfo.in/maharashtra/nashik/igatpuri.html',\n",
       " 'https://villageinfo.in/maharashtra/nashik/kalwan.html',\n",
       " 'https://villageinfo.in/maharashtra/nashik/malegaon.html',\n",
       " 'https://villageinfo.in/maharashtra/nashik/nandgaon.html',\n",
       " 'https://villageinfo.in/maharashtra/nashik/nashik.html',\n",
       " 'https://villageinfo.in/maharashtra/nashik/niphad.html',\n",
       " 'https://villageinfo.in/maharashtra/nashik/peint.html',\n",
       " 'https://villageinfo.in/maharashtra/nashik/sinnar.html',\n",
       " 'https://villageinfo.in/maharashtra/nashik/surgana.html',\n",
       " 'https://villageinfo.in/maharashtra/nashik/trimbakeshwar.html',\n",
       " 'https://villageinfo.in/maharashtra/nashik/yevla.html']"
      ]
     },
     "execution_count": 9,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "url2 = 'https://villageinfo.in/maharashtra/nashik.html'\n",
    "soup2 = get_soup(url2)\n",
    "talukas_list = get_all_links_table(soup2)\n",
    "talukas_list"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "f6b47572",
   "metadata": {
    "papermill": {
     "duration": 0.008487,
     "end_time": "2024-05-28T05:14:39.868023",
     "exception": false,
     "start_time": "2024-05-28T05:14:39.859536",
     "status": "completed"
    },
    "tags": []
   },
   "source": [
    "# get village in a taluka"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 10,
   "id": "670b1ec6",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2024-05-28T05:14:39.888594Z",
     "iopub.status.busy": "2024-05-28T05:14:39.888190Z",
     "iopub.status.idle": "2024-05-28T05:14:40.981692Z",
     "shell.execute_reply": "2024-05-28T05:14:40.980528Z"
    },
    "papermill": {
     "duration": 1.106892,
     "end_time": "2024-05-28T05:14:40.984411",
     "exception": false,
     "start_time": "2024-05-28T05:14:39.877519",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [
    {
     "data": {
      "text/plain": [
       "['https://villageinfo.in/maharashtra/nashik/niphad/ahergaon.html',\n",
       " 'https://villageinfo.in/maharashtra/nashik/niphad/amrut-nagar.html',\n",
       " 'https://villageinfo.in/maharashtra/nashik/niphad/antarweli.html',\n",
       " 'https://villageinfo.in/maharashtra/nashik/niphad/aurangpur.html',\n",
       " 'https://villageinfo.in/maharashtra/nashik/niphad/banganganagar.html',\n",
       " 'https://villageinfo.in/maharashtra/nashik/niphad/behed.html',\n",
       " 'https://villageinfo.in/maharashtra/nashik/niphad/bharwas.html',\n",
       " 'https://villageinfo.in/maharashtra/nashik/niphad/bhendali.html',\n",
       " 'https://villageinfo.in/maharashtra/nashik/niphad/bhuse.html',\n",
       " 'https://villageinfo.in/maharashtra/nashik/niphad/bokaddare.html',\n",
       " 'https://villageinfo.in/maharashtra/nashik/niphad/bramhangaon-vanas.html',\n",
       " 'https://villageinfo.in/maharashtra/nashik/niphad/bramhangaon-vinchur.html',\n",
       " 'https://villageinfo.in/maharashtra/nashik/niphad/bramhanwade.html',\n",
       " 'https://villageinfo.in/maharashtra/nashik/niphad/chandori.html',\n",
       " 'https://villageinfo.in/maharashtra/nashik/niphad/chapadgaon.html',\n",
       " 'https://villageinfo.in/maharashtra/nashik/niphad/chatori.html',\n",
       " 'https://villageinfo.in/maharashtra/nashik/niphad/chehedi-kh.html',\n",
       " 'https://villageinfo.in/maharashtra/nashik/niphad/chitegaon.html',\n",
       " 'https://villageinfo.in/maharashtra/nashik/niphad/dahegaon.html',\n",
       " 'https://villageinfo.in/maharashtra/nashik/niphad/darna-sangvi.html',\n",
       " 'https://villageinfo.in/maharashtra/nashik/niphad/datyane.html',\n",
       " 'https://villageinfo.in/maharashtra/nashik/niphad/davachwadi.html',\n",
       " 'https://villageinfo.in/maharashtra/nashik/niphad/deogaon.html',\n",
       " 'https://villageinfo.in/maharashtra/nashik/niphad/deopur.html',\n",
       " 'https://villageinfo.in/maharashtra/nashik/niphad/dhanore.html',\n",
       " 'https://villageinfo.in/maharashtra/nashik/niphad/dharangaon-khadak.html',\n",
       " 'https://villageinfo.in/maharashtra/nashik/niphad/dharangaon-veer.html',\n",
       " 'https://villageinfo.in/maharashtra/nashik/niphad/dindori.html',\n",
       " 'https://villageinfo.in/maharashtra/nashik/niphad/dixi.html',\n",
       " 'https://villageinfo.in/maharashtra/nashik/niphad/dongargaon.html',\n",
       " 'https://villageinfo.in/maharashtra/nashik/niphad/gajarwadi.html',\n",
       " 'https://villageinfo.in/maharashtra/nashik/niphad/gitakunj.html',\n",
       " 'https://villageinfo.in/maharashtra/nashik/niphad/golegaon.html',\n",
       " 'https://villageinfo.in/maharashtra/nashik/niphad/gondegaon.html',\n",
       " 'https://villageinfo.in/maharashtra/nashik/niphad/gorthan.html',\n",
       " 'https://villageinfo.in/maharashtra/nashik/niphad/hanumannagar.html',\n",
       " 'https://villageinfo.in/maharashtra/nashik/niphad/jalgaon.html',\n",
       " 'https://villageinfo.in/maharashtra/nashik/niphad/jivhale.html',\n",
       " 'https://villageinfo.in/maharashtra/nashik/niphad/kalgaon.html',\n",
       " 'https://villageinfo.in/maharashtra/nashik/niphad/kanlad.html',\n",
       " 'https://villageinfo.in/maharashtra/nashik/niphad/karanjgaon.html',\n",
       " 'https://villageinfo.in/maharashtra/nashik/niphad/karanji-kh.html',\n",
       " 'https://villageinfo.in/maharashtra/nashik/niphad/karsul.html',\n",
       " 'https://villageinfo.in/maharashtra/nashik/niphad/kasabe-sukene.html',\n",
       " 'https://villageinfo.in/maharashtra/nashik/niphad/kathargaon.html',\n",
       " 'https://villageinfo.in/maharashtra/nashik/niphad/khadak-malegaon.html',\n",
       " 'https://villageinfo.in/maharashtra/nashik/niphad/khangaon-najik.html',\n",
       " 'https://villageinfo.in/maharashtra/nashik/niphad/khangaon-thadi.html',\n",
       " 'https://villageinfo.in/maharashtra/nashik/niphad/khedale-zunge.html',\n",
       " 'https://villageinfo.in/maharashtra/nashik/niphad/khede.html',\n",
       " 'https://villageinfo.in/maharashtra/nashik/niphad/kokangaon.html',\n",
       " 'https://villageinfo.in/maharashtra/nashik/niphad/kotamgaon.html',\n",
       " 'https://villageinfo.in/maharashtra/nashik/niphad/kothure.html',\n",
       " 'https://villageinfo.in/maharashtra/nashik/niphad/kumbhari.html',\n",
       " 'https://villageinfo.in/maharashtra/nashik/niphad/kurudgaon.html',\n",
       " 'https://villageinfo.in/maharashtra/nashik/niphad/lalpadi.html',\n",
       " 'https://villageinfo.in/maharashtra/nashik/niphad/lasalgaon.html',\n",
       " 'https://villageinfo.in/maharashtra/nashik/niphad/lonwadi.html',\n",
       " 'https://villageinfo.in/maharashtra/nashik/niphad/mahadevnagar.html',\n",
       " 'https://villageinfo.in/maharashtra/nashik/niphad/mahajanpur.html',\n",
       " 'https://villageinfo.in/maharashtra/nashik/niphad/majargaon.html',\n",
       " 'https://villageinfo.in/maharashtra/nashik/niphad/manori-kh.html',\n",
       " 'https://villageinfo.in/maharashtra/nashik/niphad/maralgoi-kh.html',\n",
       " 'https://villageinfo.in/maharashtra/nashik/niphad/mauje-sukene.html',\n",
       " 'https://villageinfo.in/maharashtra/nashik/niphad/mavalgoi-bk.html',\n",
       " 'https://villageinfo.in/maharashtra/nashik/niphad/mhalsakore.html',\n",
       " 'https://villageinfo.in/maharashtra/nashik/niphad/mukhed.html',\n",
       " 'https://villageinfo.in/maharashtra/nashik/niphad/nagapur.html',\n",
       " 'https://villageinfo.in/maharashtra/nashik/niphad/naitale.html',\n",
       " 'https://villageinfo.in/maharashtra/nashik/niphad/nandgaon.html',\n",
       " 'https://villageinfo.in/maharashtra/nashik/niphad/nandur-kh.html',\n",
       " 'https://villageinfo.in/maharashtra/nashik/niphad/nandur-madhyameshwar.html',\n",
       " 'https://villageinfo.in/maharashtra/nashik/niphad/nandurdi.html',\n",
       " 'https://villageinfo.in/maharashtra/nashik/niphad/narayan-tembhi.html',\n",
       " 'https://villageinfo.in/maharashtra/nashik/niphad/narayangaon.html',\n",
       " 'https://villageinfo.in/maharashtra/nashik/niphad/nimgaon-wakada.html',\n",
       " 'https://villageinfo.in/maharashtra/nashik/niphad/niphad.html',\n",
       " 'https://villageinfo.in/maharashtra/nashik/niphad/oney.html',\n",
       " 'https://villageinfo.in/maharashtra/nashik/niphad/ozar.html',\n",
       " 'https://villageinfo.in/maharashtra/nashik/niphad/pachore-bk.html',\n",
       " 'https://villageinfo.in/maharashtra/nashik/niphad/pachore-kh.html',\n",
       " 'https://villageinfo.in/maharashtra/nashik/niphad/pachorewani.html',\n",
       " 'https://villageinfo.in/maharashtra/nashik/niphad/palkhed.html',\n",
       " 'https://villageinfo.in/maharashtra/nashik/niphad/panchkeshwar.html',\n",
       " 'https://villageinfo.in/maharashtra/nashik/niphad/pimpalas.html',\n",
       " 'https://villageinfo.in/maharashtra/nashik/niphad/pimpalgaon-baswant.html',\n",
       " 'https://villageinfo.in/maharashtra/nashik/niphad/pimpalgaon-najik.html',\n",
       " 'https://villageinfo.in/maharashtra/nashik/niphad/pimpalgaon-nipani.html',\n",
       " 'https://villageinfo.in/maharashtra/nashik/niphad/pimpri.html',\n",
       " 'https://villageinfo.in/maharashtra/nashik/niphad/ramnagar.html',\n",
       " 'https://villageinfo.in/maharashtra/nashik/niphad/rampur.html',\n",
       " 'https://villageinfo.in/maharashtra/nashik/niphad/ranwad.html',\n",
       " 'https://villageinfo.in/maharashtra/nashik/niphad/rasalpur.html',\n",
       " 'https://villageinfo.in/maharashtra/nashik/niphad/raulas.html',\n",
       " 'https://villageinfo.in/maharashtra/nashik/niphad/redgaon.html',\n",
       " 'https://villageinfo.in/maharashtra/nashik/niphad/rui.html',\n",
       " 'https://villageinfo.in/maharashtra/nashik/niphad/saikhede.html',\n",
       " 'https://villageinfo.in/maharashtra/nashik/niphad/sakore.html',\n",
       " 'https://villageinfo.in/maharashtra/nashik/niphad/sarole-kh.html',\n",
       " 'https://villageinfo.in/maharashtra/nashik/niphad/sarole-thadi.html',\n",
       " 'https://villageinfo.in/maharashtra/nashik/niphad/sawali.html',\n",
       " 'https://villageinfo.in/maharashtra/nashik/niphad/sawargaon.html',\n",
       " 'https://villageinfo.in/maharashtra/nashik/niphad/shimpi-takali.html',\n",
       " 'https://villageinfo.in/maharashtra/nashik/niphad/shingave.html',\n",
       " 'https://villageinfo.in/maharashtra/nashik/niphad/shirasgaon.html',\n",
       " 'https://villageinfo.in/maharashtra/nashik/niphad/shirwade-wakad.html',\n",
       " 'https://villageinfo.in/maharashtra/nashik/niphad/shirwade-wani.html',\n",
       " 'https://villageinfo.in/maharashtra/nashik/niphad/shivadi.html',\n",
       " 'https://villageinfo.in/maharashtra/nashik/niphad/shivare.html',\n",
       " 'https://villageinfo.in/maharashtra/nashik/niphad/shiwapur.html',\n",
       " 'https://villageinfo.in/maharashtra/nashik/niphad/shriram-nagar.html',\n",
       " 'https://villageinfo.in/maharashtra/nashik/niphad/shrirampur.html',\n",
       " 'https://villageinfo.in/maharashtra/nashik/niphad/sonewadi-bk.html',\n",
       " 'https://villageinfo.in/maharashtra/nashik/niphad/sonewadi-kh.html',\n",
       " 'https://villageinfo.in/maharashtra/nashik/niphad/songaon.html',\n",
       " 'https://villageinfo.in/maharashtra/nashik/niphad/subhash-nagar.html',\n",
       " 'https://villageinfo.in/maharashtra/nashik/niphad/sundarpur.html',\n",
       " 'https://villageinfo.in/maharashtra/nashik/niphad/takali-vinchur.html',\n",
       " 'https://villageinfo.in/maharashtra/nashik/niphad/talwade.html',\n",
       " 'https://villageinfo.in/maharashtra/nashik/niphad/tamaswadi.html',\n",
       " 'https://villageinfo.in/maharashtra/nashik/niphad/tarukhedle.html',\n",
       " 'https://villageinfo.in/maharashtra/nashik/niphad/thergaon.html',\n",
       " 'https://villageinfo.in/maharashtra/nashik/niphad/thetale.html',\n",
       " 'https://villageinfo.in/maharashtra/nashik/niphad/ugaon.html',\n",
       " 'https://villageinfo.in/maharashtra/nashik/niphad/umbarkhed.html',\n",
       " 'https://villageinfo.in/maharashtra/nashik/niphad/vadali-najik.html',\n",
       " 'https://villageinfo.in/maharashtra/nashik/niphad/vanasgaon.html',\n",
       " 'https://villageinfo.in/maharashtra/nashik/niphad/varhe-davna.html',\n",
       " 'https://villageinfo.in/maharashtra/nashik/niphad/vijay-nagar.html',\n",
       " 'https://villageinfo.in/maharashtra/nashik/niphad/vinchur.html',\n",
       " 'https://villageinfo.in/maharashtra/nashik/niphad/vishnu-nagar.html',\n",
       " 'https://villageinfo.in/maharashtra/nashik/niphad/vitthalwadi.html',\n",
       " 'https://villageinfo.in/maharashtra/nashik/niphad/wahegaon.html',\n",
       " 'https://villageinfo.in/maharashtra/nashik/niphad/wakad.html',\n",
       " 'https://villageinfo.in/maharashtra/nashik/niphad/wavi.html',\n",
       " 'https://villageinfo.in/maharashtra/nashik/niphad/welapur.html']"
      ]
     },
     "execution_count": 10,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "url3 = 'https://villageinfo.in/maharashtra/nashik/niphad.html'\n",
    "soup3 = get_soup(url3)\n",
    "vill_list = get_all_links_table(soup3)\n",
    "vill_list"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "3c99d207",
   "metadata": {
    "papermill": {
     "duration": 0.0093,
     "end_time": "2024-05-28T05:14:41.003156",
     "exception": false,
     "start_time": "2024-05-28T05:14:40.993856",
     "status": "completed"
    },
    "tags": []
   },
   "source": [
    "# filter out now "
   ]
  },
  {
   "cell_type": "markdown",
   "id": "bd4d37d4",
   "metadata": {
    "papermill": {
     "duration": 0.008671,
     "end_time": "2024-05-28T05:14:41.020862",
     "exception": false,
     "start_time": "2024-05-28T05:14:41.012191",
     "status": "completed"
    },
    "tags": []
   },
   "source": [
    "## states"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 11,
   "id": "e8d57667",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2024-05-28T05:14:41.041525Z",
     "iopub.status.busy": "2024-05-28T05:14:41.040533Z",
     "iopub.status.idle": "2024-05-28T05:14:41.048189Z",
     "shell.execute_reply": "2024-05-28T05:14:41.046968Z"
    },
    "papermill": {
     "duration": 0.020626,
     "end_time": "2024-05-28T05:14:41.050542",
     "exception": false,
     "start_time": "2024-05-28T05:14:41.029916",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [
    {
     "data": {
      "text/plain": [
       "['https://villageinfo.in/andaman-&-nicobar-islands.html',\n",
       " 'https://villageinfo.in/andhra-pradesh.html',\n",
       " 'https://villageinfo.in/arunachal-pradesh.html',\n",
       " 'https://villageinfo.in/assam.html',\n",
       " 'https://villageinfo.in/bihar.html',\n",
       " 'https://villageinfo.in/chandigarh.html',\n",
       " 'https://villageinfo.in/chhattisgarh.html',\n",
       " 'https://villageinfo.in/dadra-&-nagar-haveli.html',\n",
       " 'https://villageinfo.in/daman-&-diu.html',\n",
       " 'https://villageinfo.in/delhi.html',\n",
       " 'https://villageinfo.in/goa.html',\n",
       " 'https://villageinfo.in/gujarat.html',\n",
       " 'https://villageinfo.in/haryana.html',\n",
       " 'https://villageinfo.in/himachal-pradesh.html',\n",
       " 'https://villageinfo.in/jammu-&-kashmir.html',\n",
       " 'https://villageinfo.in/jharkhand.html',\n",
       " 'https://villageinfo.in/karnataka.html',\n",
       " 'https://villageinfo.in/kerala.html',\n",
       " 'https://villageinfo.in/lakshadweep.html',\n",
       " 'https://villageinfo.in/madhya-pradesh.html',\n",
       " 'https://villageinfo.in/maharashtra.html',\n",
       " 'https://villageinfo.in/manipur.html',\n",
       " 'https://villageinfo.in/meghalaya.html',\n",
       " 'https://villageinfo.in/mizoram.html',\n",
       " 'https://villageinfo.in/nagaland.html',\n",
       " 'https://villageinfo.in/odisha.html',\n",
       " 'https://villageinfo.in/puducherry.html',\n",
       " 'https://villageinfo.in/punjab.html',\n",
       " 'https://villageinfo.in/rajasthan.html',\n",
       " 'https://villageinfo.in/sikkim.html',\n",
       " 'https://villageinfo.in/tamil-nadu.html',\n",
       " 'https://villageinfo.in/telangana.html',\n",
       " 'https://villageinfo.in/tripura.html',\n",
       " 'https://villageinfo.in/uttar-pradesh.html',\n",
       " 'https://villageinfo.in/uttarakhand.html',\n",
       " 'https://villageinfo.in/west-bengal.html']"
      ]
     },
     "execution_count": 11,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "states_list_f = states_list[:-4]\n",
    "states_list_f"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "22f1e80c",
   "metadata": {
    "papermill": {
     "duration": 0.009095,
     "end_time": "2024-05-28T05:14:41.070167",
     "exception": false,
     "start_time": "2024-05-28T05:14:41.061072",
     "status": "completed"
    },
    "tags": []
   },
   "source": [
    "# mass scrapping"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 12,
   "id": "32902e25",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2024-05-28T05:14:41.091154Z",
     "iopub.status.busy": "2024-05-28T05:14:41.090749Z",
     "iopub.status.idle": "2024-05-28T05:14:41.097096Z",
     "shell.execute_reply": "2024-05-28T05:14:41.095495Z"
    },
    "papermill": {
     "duration": 0.020355,
     "end_time": "2024-05-28T05:14:41.100018",
     "exception": false,
     "start_time": "2024-05-28T05:14:41.079663",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [],
   "source": [
    "# district_list_mega = []\n",
    "# talukas_list_mega = []\n",
    "# villages_list_mega = []\n",
    "\n",
    "# for state_link in states_list_f:\n",
    "#     # print(state_link)\n",
    "#     soup = get_soup(state_link)\n",
    "#     district_list = get_all_links_table(soup)\n",
    "#     district_list_mega.extend(district_list)  \n",
    "\n",
    "#     for district_link in district_list:\n",
    "#         # print(district_link)\n",
    "#         soup = get_soup(district_link)\n",
    "#         talukas_list = get_all_links_table(soup)\n",
    "#         talukas_list_mega.extend(talukas_list) \n",
    "\n",
    "#         for talukas_link in talukas_list:\n",
    "#             # print(talukas_link)\n",
    "#             soup = get_soup(talukas_link)\n",
    "#             villages_list = get_all_links_table(soup)\n",
    "#             villages_list_mega.extend(villages_list)  \n",
    "        \n",
    "#         time.sleep(5)\n",
    "#     time.sleep(10)\n",
    "#     filename = state_link.replace('/','.')\n",
    "#     filename = filename.split('.')[-2]\n",
    "#     with open(f'{filename}.txt', 'a') as file:  \n",
    "#         for village in villages_list_mega:\n",
    "#             file.write(f\"{village}\\n\")\n",
    "#     print(f'file : {filename} written successfully .\\n')\n",
    "\n",
    "# print(len(district_list_mega))\n",
    "# print(len(talukas_list_mega))\n",
    "# print(len(villages_list_mega))"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "a88fd68c",
   "metadata": {
    "papermill": {
     "duration": 0.009073,
     "end_time": "2024-05-28T05:14:41.118743",
     "exception": false,
     "start_time": "2024-05-28T05:14:41.109670",
     "status": "completed"
    },
    "tags": []
   },
   "source": [
    "# code to collect data in detail "
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 13,
   "id": "d2dd3625",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2024-05-28T05:14:41.139244Z",
     "iopub.status.busy": "2024-05-28T05:14:41.138870Z",
     "iopub.status.idle": "2024-05-28T05:14:41.143923Z",
     "shell.execute_reply": "2024-05-28T05:14:41.142640Z"
    },
    "papermill": {
     "duration": 0.018137,
     "end_time": "2024-05-28T05:14:41.146253",
     "exception": false,
     "start_time": "2024-05-28T05:14:41.128116",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [],
   "source": [
    "url = \"https://villageinfo.in/maharashtra/nashik/niphad/ahergaon.html\""
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 14,
   "id": "4613752d",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2024-05-28T05:14:41.166775Z",
     "iopub.status.busy": "2024-05-28T05:14:41.166393Z",
     "iopub.status.idle": "2024-05-28T05:14:41.928680Z",
     "shell.execute_reply": "2024-05-28T05:14:41.927411Z"
    },
    "papermill": {
     "duration": 0.775706,
     "end_time": "2024-05-28T05:14:41.931351",
     "exception": false,
     "start_time": "2024-05-28T05:14:41.155645",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [],
   "source": [
    "r = rq.get(url,headers = headers)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 15,
   "id": "033e5772",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2024-05-28T05:14:41.952146Z",
     "iopub.status.busy": "2024-05-28T05:14:41.951778Z",
     "iopub.status.idle": "2024-05-28T05:14:41.969997Z",
     "shell.execute_reply": "2024-05-28T05:14:41.968788Z"
    },
    "papermill": {
     "duration": 0.031582,
     "end_time": "2024-05-28T05:14:41.972473",
     "exception": false,
     "start_time": "2024-05-28T05:14:41.940891",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [],
   "source": [
    "soup = BeautifulSoup(r.text,'html.parser')"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 16,
   "id": "9ea73b38",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2024-05-28T05:14:41.993867Z",
     "iopub.status.busy": "2024-05-28T05:14:41.993030Z",
     "iopub.status.idle": "2024-05-28T05:14:41.998148Z",
     "shell.execute_reply": "2024-05-28T05:14:41.997264Z"
    },
    "papermill": {
     "duration": 0.017874,
     "end_time": "2024-05-28T05:14:42.000305",
     "exception": false,
     "start_time": "2024-05-28T05:14:41.982431",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [],
   "source": [
    "tables = soup.find('table')"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 17,
   "id": "f13d8962",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2024-05-28T05:14:42.021152Z",
     "iopub.status.busy": "2024-05-28T05:14:42.020121Z",
     "iopub.status.idle": "2024-05-28T05:14:42.038904Z",
     "shell.execute_reply": "2024-05-28T05:14:42.037636Z"
    },
    "papermill": {
     "duration": 0.032045,
     "end_time": "2024-05-28T05:14:42.041653",
     "exception": false,
     "start_time": "2024-05-28T05:14:42.009608",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>0</th>\n",
       "      <th>1</th>\n",
       "      <th>2</th>\n",
       "      <th>3</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>Particulars</td>\n",
       "      <td>Total</td>\n",
       "      <td>Male</td>\n",
       "      <td>Female</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>Total Population</td>\n",
       "      <td>3,107</td>\n",
       "      <td>1,618</td>\n",
       "      <td>1,489</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>Literate Population</td>\n",
       "      <td>2,328</td>\n",
       "      <td>1,276</td>\n",
       "      <td>1,052</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>Illiterate Population</td>\n",
       "      <td>779</td>\n",
       "      <td>342</td>\n",
       "      <td>437</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "                       0      1      2       3\n",
       "0            Particulars  Total   Male  Female\n",
       "1       Total Population  3,107  1,618   1,489\n",
       "2    Literate Population  2,328  1,276   1,052\n",
       "3  Illiterate Population    779    342     437"
      ]
     },
     "execution_count": 17,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "tables = construct_table(tables)\n",
    "tables_df = pd.DataFrame(tables)\n",
    "tables_df"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 18,
   "id": "51c77f8e",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2024-05-28T05:14:42.062984Z",
     "iopub.status.busy": "2024-05-28T05:14:42.062614Z",
     "iopub.status.idle": "2024-05-28T05:14:42.070909Z",
     "shell.execute_reply": "2024-05-28T05:14:42.069686Z"
    },
    "papermill": {
     "duration": 0.022145,
     "end_time": "2024-05-28T05:14:42.073391",
     "exception": false,
     "start_time": "2024-05-28T05:14:42.051246",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "[['Particulars', 'Total', 'Male', 'Female'], ['Total Population', '3,107', '1,618', '1,489'], ['Literate Population', '2,328', '1,276', '1,052'], ['Illiterate Population', '779', '342', '437']] \n",
      "\n",
      "\n",
      "[['Ahergaon - Village Overview'], ['Gram Panchayat : ', 'Ahergaon'], ['Block / Tehsil : ', 'Niphad'], ['District : ', 'Nashik'], ['State : ', 'Maharashtra'], ['Pincode : ', 'N/A'], ['Area : ', '852 hectares'], ['Population : ', '3,107'], ['Households : ', '594'], ['Assembly Constituency : ', 'Niphad'], ['Parliament Constituency : ', 'Dindori'], ['Nearest Town : ', 'Nashik (37 km)']] \n",
      "\n",
      "\n",
      "[['Related Pages'], ['List of Villages in Niphad'], ['List of Tehsils in Nashik'], ['List of Districts in Maharashtra']] \n",
      "\n",
      "\n"
     ]
    }
   ],
   "source": [
    "tables = soup.find_all('table')\n",
    "\n",
    "for i in tables:\n",
    "    tab = construct_table(i)\n",
    "    tables_df = pd.DataFrame(tab)\n",
    "    print(tab,'\\n\\n')"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 19,
   "id": "b72c4707",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2024-05-28T05:14:42.094620Z",
     "iopub.status.busy": "2024-05-28T05:14:42.094190Z",
     "iopub.status.idle": "2024-05-28T05:14:42.102600Z",
     "shell.execute_reply": "2024-05-28T05:14:42.101424Z"
    },
    "papermill": {
     "duration": 0.022061,
     "end_time": "2024-05-28T05:14:42.105095",
     "exception": false,
     "start_time": "2024-05-28T05:14:42.083034",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [
    {
     "data": {
      "text/plain": [
       "[<div class=\"column\" data-label=\"Connectivity Type\">Public Bus Service</div>,\n",
       " <div class=\"column\" data-label=\"Connectivity Type\">Private Bus Service</div>,\n",
       " <div class=\"column\" data-label=\"Connectivity Type\">Railway Station</div>]"
      ]
     },
     "execution_count": 19,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "soup.find_all('div',{'data-label':'Connectivity Type'})"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 20,
   "id": "21ccf972",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2024-05-28T05:14:42.127294Z",
     "iopub.status.busy": "2024-05-28T05:14:42.126201Z",
     "iopub.status.idle": "2024-05-28T05:14:42.135658Z",
     "shell.execute_reply": "2024-05-28T05:14:42.134307Z"
    },
    "papermill": {
     "duration": 0.022956,
     "end_time": "2024-05-28T05:14:42.138232",
     "exception": false,
     "start_time": "2024-05-28T05:14:42.115276",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [
    {
     "data": {
      "text/plain": [
       "[<div class=\"column\" data-label=\"Status\">Status</div>,\n",
       " <div class=\"column\" data-label=\"Status\">Available within village</div>,\n",
       " <div class=\"column\" data-label=\"Status\">Available within 5 - 10 km distance</div>,\n",
       " <div class=\"column\" data-label=\"Status\">Available within 10+ km distance</div>]"
      ]
     },
     "execution_count": 20,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "soup.find_all('div',{'data-label':'Status'})"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 21,
   "id": "1a72f254",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2024-05-28T05:14:42.160361Z",
     "iopub.status.busy": "2024-05-28T05:14:42.159287Z",
     "iopub.status.idle": "2024-05-28T05:14:42.163603Z",
     "shell.execute_reply": "2024-05-28T05:14:42.162786Z"
    },
    "papermill": {
     "duration": 0.01773,
     "end_time": "2024-05-28T05:14:42.165873",
     "exception": false,
     "start_time": "2024-05-28T05:14:42.148143",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [],
   "source": [
    "final_data_list = {}"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "a0d439ea",
   "metadata": {
    "papermill": {
     "duration": 0.009511,
     "end_time": "2024-05-28T05:14:42.185572",
     "exception": false,
     "start_time": "2024-05-28T05:14:42.176061",
     "status": "completed"
    },
    "tags": []
   },
   "source": [
    "# Ned to get latitude and longitude "
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 22,
   "id": "79740737",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2024-05-28T05:14:42.207226Z",
     "iopub.status.busy": "2024-05-28T05:14:42.206807Z",
     "iopub.status.idle": "2024-05-28T05:14:42.211516Z",
     "shell.execute_reply": "2024-05-28T05:14:42.210333Z"
    },
    "papermill": {
     "duration": 0.018337,
     "end_time": "2024-05-28T05:14:42.213645",
     "exception": false,
     "start_time": "2024-05-28T05:14:42.195308",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [],
   "source": [
    "# https://www.geonames.org/search.html?q=vinchur%2Cnashik%2Cmaharashtra&country=IN"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 23,
   "id": "76956957",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2024-05-28T05:14:42.235140Z",
     "iopub.status.busy": "2024-05-28T05:14:42.234322Z",
     "iopub.status.idle": "2024-05-28T05:14:43.300364Z",
     "shell.execute_reply": "2024-05-28T05:14:43.299168Z"
    },
    "papermill": {
     "duration": 1.079381,
     "end_time": "2024-05-28T05:14:43.302773",
     "exception": false,
     "start_time": "2024-05-28T05:14:42.223392",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>Unnamed: 0</th>\n",
       "      <th>country</th>\n",
       "      <th>state</th>\n",
       "      <th>district</th>\n",
       "      <th>taluka</th>\n",
       "      <th>village</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>0</td>\n",
       "      <td>India</td>\n",
       "      <td>andaman-&amp;-nicobar-islands</td>\n",
       "      <td>nicobars</td>\n",
       "      <td>car-nicobar</td>\n",
       "      <td>arong</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>1</td>\n",
       "      <td>India</td>\n",
       "      <td>andaman-&amp;-nicobar-islands</td>\n",
       "      <td>nicobars</td>\n",
       "      <td>car-nicobar</td>\n",
       "      <td>big-lapati</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>2</td>\n",
       "      <td>India</td>\n",
       "      <td>andaman-&amp;-nicobar-islands</td>\n",
       "      <td>nicobars</td>\n",
       "      <td>car-nicobar</td>\n",
       "      <td>chuckchucha</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>3</td>\n",
       "      <td>India</td>\n",
       "      <td>andaman-&amp;-nicobar-islands</td>\n",
       "      <td>nicobars</td>\n",
       "      <td>car-nicobar</td>\n",
       "      <td>iaf-camp</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>4</td>\n",
       "      <td>India</td>\n",
       "      <td>andaman-&amp;-nicobar-islands</td>\n",
       "      <td>nicobars</td>\n",
       "      <td>car-nicobar</td>\n",
       "      <td>kakana</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>...</th>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>619285</th>\n",
       "      <td>619285</td>\n",
       "      <td>India</td>\n",
       "      <td>west-bengal</td>\n",
       "      <td>uttar-dinajpur</td>\n",
       "      <td>raiganj</td>\n",
       "      <td>teghara</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>619286</th>\n",
       "      <td>619286</td>\n",
       "      <td>India</td>\n",
       "      <td>west-bengal</td>\n",
       "      <td>uttar-dinajpur</td>\n",
       "      <td>raiganj</td>\n",
       "      <td>tenahari</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>619287</th>\n",
       "      <td>619287</td>\n",
       "      <td>India</td>\n",
       "      <td>west-bengal</td>\n",
       "      <td>uttar-dinajpur</td>\n",
       "      <td>raiganj</td>\n",
       "      <td>tenra</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>619288</th>\n",
       "      <td>619288</td>\n",
       "      <td>India</td>\n",
       "      <td>west-bengal</td>\n",
       "      <td>uttar-dinajpur</td>\n",
       "      <td>raiganj</td>\n",
       "      <td>udaypur</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>619289</th>\n",
       "      <td>619289</td>\n",
       "      <td>India</td>\n",
       "      <td>west-bengal</td>\n",
       "      <td>uttar-dinajpur</td>\n",
       "      <td>raiganj</td>\n",
       "      <td>uttar-goalpara</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>619290 rows × 6 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "        Unnamed: 0 country                      state        district  \\\n",
       "0                0   India  andaman-&-nicobar-islands        nicobars   \n",
       "1                1   India  andaman-&-nicobar-islands        nicobars   \n",
       "2                2   India  andaman-&-nicobar-islands        nicobars   \n",
       "3                3   India  andaman-&-nicobar-islands        nicobars   \n",
       "4                4   India  andaman-&-nicobar-islands        nicobars   \n",
       "...            ...     ...                        ...             ...   \n",
       "619285      619285   India                west-bengal  uttar-dinajpur   \n",
       "619286      619286   India                west-bengal  uttar-dinajpur   \n",
       "619287      619287   India                west-bengal  uttar-dinajpur   \n",
       "619288      619288   India                west-bengal  uttar-dinajpur   \n",
       "619289      619289   India                west-bengal  uttar-dinajpur   \n",
       "\n",
       "             taluka         village  \n",
       "0       car-nicobar           arong  \n",
       "1       car-nicobar      big-lapati  \n",
       "2       car-nicobar     chuckchucha  \n",
       "3       car-nicobar        iaf-camp  \n",
       "4       car-nicobar          kakana  \n",
       "...             ...             ...  \n",
       "619285      raiganj         teghara  \n",
       "619286      raiganj        tenahari  \n",
       "619287      raiganj           tenra  \n",
       "619288      raiganj         udaypur  \n",
       "619289      raiganj  uttar-goalpara  \n",
       "\n",
       "[619290 rows x 6 columns]"
      ]
     },
     "execution_count": 23,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "df = pd.read_csv('/kaggle/input/indian-villages-database/indian_villages_database.csv')\n",
    "df"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 24,
   "id": "2b6c898b",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2024-05-28T05:14:43.325023Z",
     "iopub.status.busy": "2024-05-28T05:14:43.324669Z",
     "iopub.status.idle": "2024-05-28T05:14:43.328566Z",
     "shell.execute_reply": "2024-05-28T05:14:43.327696Z"
    },
    "papermill": {
     "duration": 0.017816,
     "end_time": "2024-05-28T05:14:43.330893",
     "exception": false,
     "start_time": "2024-05-28T05:14:43.313077",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [],
   "source": [
    "url_to_hit = \"https://www.geonames.org/advanced-search.html?q=Vinchur%2Cnashik%2Cmaharashtra&country=IN&featureClass=&continentCode=\""
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 25,
   "id": "11129dc6",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2024-05-28T05:14:43.353093Z",
     "iopub.status.busy": "2024-05-28T05:14:43.352666Z",
     "iopub.status.idle": "2024-05-28T05:14:43.891550Z",
     "shell.execute_reply": "2024-05-28T05:14:43.890356Z"
    },
    "papermill": {
     "duration": 0.553045,
     "end_time": "2024-05-28T05:14:43.894163",
     "exception": false,
     "start_time": "2024-05-28T05:14:43.341118",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [],
   "source": [
    "r = rq.get(url_to_hit,headers = headers)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 26,
   "id": "03e2cc52",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2024-05-28T05:14:43.916725Z",
     "iopub.status.busy": "2024-05-28T05:14:43.916286Z",
     "iopub.status.idle": "2024-05-28T05:14:43.941666Z",
     "shell.execute_reply": "2024-05-28T05:14:43.940423Z"
    },
    "papermill": {
     "duration": 0.039577,
     "end_time": "2024-05-28T05:14:43.944391",
     "exception": false,
     "start_time": "2024-05-28T05:14:43.904814",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [],
   "source": [
    "soup = BeautifulSoup(r.text,'html.parser')"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 27,
   "id": "121d6c84",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2024-05-28T05:14:43.966390Z",
     "iopub.status.busy": "2024-05-28T05:14:43.965934Z",
     "iopub.status.idle": "2024-05-28T05:14:43.974640Z",
     "shell.execute_reply": "2024-05-28T05:14:43.973462Z"
    },
    "papermill": {
     "duration": 0.022091,
     "end_time": "2024-05-28T05:14:43.976715",
     "exception": false,
     "start_time": "2024-05-28T05:14:43.954624",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [
    {
     "data": {
      "text/plain": [
       "<span class=\"latitude\">20.104085</span>"
      ]
     },
     "execution_count": 27,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "soup.find('span',{'class':'latitude'})"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 28,
   "id": "44ec84fd",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2024-05-28T05:14:43.999663Z",
     "iopub.status.busy": "2024-05-28T05:14:43.999230Z",
     "iopub.status.idle": "2024-05-28T05:14:44.008303Z",
     "shell.execute_reply": "2024-05-28T05:14:44.006836Z"
    },
    "papermill": {
     "duration": 0.023698,
     "end_time": "2024-05-28T05:14:44.010995",
     "exception": false,
     "start_time": "2024-05-28T05:14:43.987297",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [
    {
     "data": {
      "text/plain": [
       "<span class=\"longitude\">74.226091</span>"
      ]
     },
     "execution_count": 28,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "soup.find('span',{'class':'longitude'})"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 29,
   "id": "0ad8e2e8",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2024-05-28T05:14:44.035513Z",
     "iopub.status.busy": "2024-05-28T05:14:44.034326Z",
     "iopub.status.idle": "2024-05-28T05:14:48.877740Z",
     "shell.execute_reply": "2024-05-28T05:14:48.876267Z"
    },
    "papermill": {
     "duration": 4.859146,
     "end_time": "2024-05-28T05:14:48.881237",
     "exception": false,
     "start_time": "2024-05-28T05:14:44.022091",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "9it [00:04,  2.14it/s]"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "<span class=\"latitude\">9.1666667</span>\n",
      "<span class=\"longitude\">92.8166667</span>\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "10it [00:04,  2.07it/s]"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "<span class=\"latitude\">9.2333333</span>\n",
      "<span class=\"longitude\">92.7833333</span>\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "\n"
     ]
    }
   ],
   "source": [
    "latlist = []\n",
    "lonlist = []\n",
    "\n",
    "for index, row in tqdm(df.head(10).iterrows()):\n",
    "    state = row.iloc[2]\n",
    "    district = row.iloc[3]\n",
    "    taluka = row.iloc[4]\n",
    "    village = row.iloc[5]\n",
    "    url_to_hit = f\"https://www.geonames.org/advanced-search.html?q={village}%2C{taluka}%2C{district}%2C{state}&country=IN&featureClass=&continentCode=\"  \n",
    "    r = rq.get(url_to_hit,headers = headers)    \n",
    "    soup = BeautifulSoup(r.text,'html.parser')   \n",
    "    lat = soup.find('span',{'class':'latitude'})    \n",
    "    lon = soup.find('span',{'class':'longitude'})   \n",
    "    if lat is not None and lon is not None:\n",
    "        latlist.append(lat.text)\n",
    "        lonlist.append(lon.text)\n",
    "        print(lat)\n",
    "        print(lon)\n",
    "    else:\n",
    "        latlist.append(None)\n",
    "        lonlist.append(None)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 30,
   "id": "1f829793",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2024-05-28T05:14:48.905811Z",
     "iopub.status.busy": "2024-05-28T05:14:48.905428Z",
     "iopub.status.idle": "2024-05-28T05:14:48.910911Z",
     "shell.execute_reply": "2024-05-28T05:14:48.910149Z"
    },
    "papermill": {
     "duration": 0.021526,
     "end_time": "2024-05-28T05:14:48.914398",
     "exception": false,
     "start_time": "2024-05-28T05:14:48.892872",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [
    {
     "data": {
      "text/plain": [
       "[None, None, None, None, None, None, None, None, '9.1666667', '9.2333333']"
      ]
     },
     "execution_count": 30,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "latlist"
   ]
  }
 ],
 "metadata": {
  "kaggle": {
   "accelerator": "none",
   "dataSources": [
    {
     "datasetId": 5093156,
     "sourceId": 8528497,
     "sourceType": "datasetVersion"
    }
   ],
   "dockerImageVersionId": 30698,
   "isGpuEnabled": false,
   "isInternetEnabled": true,
   "language": "python",
   "sourceType": "notebook"
  },
  "kernelspec": {
   "display_name": "Python 3",
   "language": "python",
   "name": "python3"
  },
  "language_info": {
   "codemirror_mode": {
    "name": "ipython",
    "version": 3
   },
   "file_extension": ".py",
   "mimetype": "text/x-python",
   "name": "python",
   "nbconvert_exporter": "python",
   "pygments_lexer": "ipython3",
   "version": "3.10.13"
  },
  "papermill": {
   "default_parameters": {},
   "duration": 16.654525,
   "end_time": "2024-05-28T05:14:49.451679",
   "environment_variables": {},
   "exception": null,
   "input_path": "__notebook__.ipynb",
   "output_path": "__notebook__.ipynb",
   "parameters": {},
   "start_time": "2024-05-28T05:14:32.797154",
   "version": "2.5.0"
  }
 },
 "nbformat": 4,
 "nbformat_minor": 5
}
